
<script type="text/javascript"> 

var Lib_Tween =
{
	None: function(pct)
	{
		return pct;
	},
	Quad: function(pct)
	{
		return -(Math.pow((pct-1), 2) -1);
	}
}


var Lib_Route =
{
	Line: function(obj, originxy, targetxy, d)
	{
		var Distance = targetxy.getDistance(originxy);
		obj.style.left = originxy.x + Distance.scale(d).dx + 'px';
		obj.style.top = originxy.y + Distance.scale(d).dy + 'px';
	}
}

function DistanceXY(dx, dy)
{
	this.dx = dx;
	this.dy = dy;
	this.scale = function(s)
	{
		return new DistanceXY(this.dx * s, this.dy * s);
	}
}
function AbsoluteXY(x, y)
{
	this.x = x;
	this.y = y;
	this.Plus = function(d)
	{
		this.x = x + d.dx;
		this.y = y + d.dy;
		return this;
	}
	this.getDistance = function(abxy)
	{
		return new DistanceXY(this.x - abxy.x, 
								this.y - abxy.y)
	}
}


function Move(Object)
{
	var OriginalPos = new AbsoluteXY(
							parseInt(Object.style.left),
							parseInt(Object.style.top)
							);
	var Tween = 'None';
	var Time = 500;
	var To = OriginalPos;
	
	var Route = Lib_Route['Line'];
	var CallBack = function(){};
	
	
	//Getters
	this.getTo = function()
	{
		return To;
	}
	this.getFrom = function()
	{
		return OriginalPos;
	}
	
	//Setters
	this.Tween = function(anm)
	{
		Tween = Lib_Tween[anm];
		return this;
	};	
	this.Time = function(tm)
	{
		Time = tm;
		return this;
	};
	this.To = function(to)
	{	
		To = to;
		return this;
	};
	this.Route = function(rt)
	{	
		Route = Lib_Route[rt];
		return this;
	};
	this.CallBack = function(cb)
	{
		CallBack = cb;
		return this;
	};
	this.Excute = function()
	{
		var StartTime = new Date().getTime();
		function Run()
		{
			var NewTime = new Date().getTime();
			var d = Tween((NewTime - StartTime) / parseFloat(Time));
			//no noun,change to verb
			Route(Object, OriginalPos, To, d);
			if (Time >= (NewTime - StartTime))
				setTimeout(Run, 1);
			else
			{
				Object.style.left = To.x + 'px';
				Object.style.top = To.y + 'px';
				CallBack(this);
			}
		}
		Run();
		return this;
	};
	return this;
}


function test1()
{
	var target1 = new AbsoluteXY(200, 300);	
	var aMove = new Move('box').Tween('None').Time(300).Route('Line').To(target1).CallBack(
		function(move)
		{
			new Move('box').Tween('Quad').Time(300).Route('Line').To(move.getFrom()).
		}
	).Excute();
}
</script>
<button onclick = "test1()" >Test!!</button>
<div id = 'box'; style="border: 1px solid #666666; height:100px; width:200px; left:0px; top:200px; position: absolute" >
</div>