
<script type="text/javascript"> 

var Lib_Tween =
{
	'None': function(pct)
	{
		return pct;
	},
	'Quad': function(pct)
	{
		return -(Math.pow((pct-1), 2) -1);
	}
}


function Hide(Object)
{	
	var Tween = Lib_Tween['None'];
	var Time = 500;
	var EndOpacity = 0;
	var CallBack = function(){};	
	//Getters
		
	//Setters
	this.Tween = function(tn)
	{
		Tween = Lib_Tween[tn];
		return this;
	};	
	this.Time = function(tm)
	{
		Time = tm;
		return this;
	};
	this.EndOpacity = function(eo)
	{	
		EndOpacity = eo;
		return this;
	};	
	this.CallBack = function(cb)
	{
		CallBack = cb;
		return this;
	};
	this.Excute = function()
	{
		Object.style.display = 'block';
		var StartOpacity = parseFloat(Object.style.opacity);
		var StartTime = new Date().getTime();
		function Run()
		{
			var NewTime = new Date().getTime();
			var d = Tween((NewTime - StartTime) / parseFloat(Time));
			
			//alert(Object.style.opacity);
			if (Time >= (NewTime - StartTime))
			{
				Object.style.opacity = StartOpacity + d * (EndOpacity - StartOpacity);				
				setTimeout(Run, 10);
			}
			else
			{
				Object.style.opacity = EndOpacity;
		//		if (EndOpacity == 0)
		//			Object.style.display = 'none';
				CallBack(this);
			}
		}
		Run();
		return this;
	};
	return this;
}


function test1()
{
	var Box = document.getElementById('box');
	var aShow = Hide(Box).Excute();
}
</script>
<button onclick = "test1()" >Test!!</button>
<div id = 'box'; style="opacity: 0.7;border: 1px solid #666666; height:100px; width:200px; left:0px; top:200px; position: absolute" >
</div>